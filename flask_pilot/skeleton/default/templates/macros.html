"""
Flask-Pilot Macros
Place your macros in here
"""

# ---- include_css_file() ------------------------------------------------------
{%- macro include_css_file(file) -%}
    {%- if file.startswith('http') or file.startswith('//')  -%}
        {%- set src = file -%}
    {%- else -%}
        {% set src = url_for('static', filename=file) %}
    {%- endif -%}
    <link href="{{ src | safe }}" rel="stylesheet">
{%- endmacro -%}


# ---- include_js_file() ------------------------------------------------------
{%- macro include_js_file(file) -%}
    {%- if file.startswith('http') or file.startswith('//')  -%}
        {%- set src = file -%}
    {%- else -%}
        {%- set src = url_for('static', filename=file) -%}
    {%- endif -%}
    <script type="text/javascript" src="{{ src | safe }}"></script>
{%- endmacro -%}


# ---- img_src() ------------------------------------------------------
{% macro img_src(file, attributes={}) %}
    {%- if file.startswith('http') or file.startswith('//')  %}
        {% set src = file %}
    {% else %}
        {% set src = url_for('static', filename=file) %}
    {% endif -%}

    <img src="{{ src | safe}}"
            {%- for k, v in attributes.items() %}
                {{ k | safe}}="{{ v | safe}}"
            {% endfor -%}
            >
{% endmacro %}


# ---- static_url() ------------------------------------------------------
{% macro static_url(url) %}
    {%- if not file.startswith('http') and not file.startswith('//')  %}
        {% set url = url_for('static', filename=file) %}
    {% endif -%}
    {{ url | safe }}
{% endmacro %}


# ---- google_analytics() ------------------------------------------------------

{% macro google_analytics(code) %}
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', '{{ code }}', 'auto');
	  ga('send', 'pageview');
	</script>
{% endmacro %}


#---- flashed_messages() -------------------------------------------------------
# Render the flashed messages set
{% macro flashed_messages(dismissible=True) %}
    {% for category, message in __flashed_messages__ %}
        <div class="alert
            alert-{{category|replace('error', 'danger')}}
            {% if dismissible %}alert-dismissible{%endif%}
            " role="alert">
            {% if dismissible %}
             <button type="button" class="close" data-dismiss="alert">
                 <span aria-hidden="true">&times;</span>
                 <span class="sr-only">Close</span>
             </button>
            {%endif%}
            {{message}}
        </div>
    {%endfor%}
{% endmacro %}



#---- alert_message() ----------------------------------------------------------
{% macro alert_message(message, category="info", dismissible=False) %}
    <div class="alert
        alert-{{category|replace('error', 'danger')}}
        {% if dismissible %}alert-dismissible{%endif%}
        " role="alert">
        {% if dismissible %}
         <button type="button" class="close" data-dismiss="alert">
             <span aria-hidden="true">&times;</span>
             <span class="sr-only">Close</span>
         </button>
        {%endif%}
        {{message}}
    </div>
{% endmacro %}


#---- show_pagination() --------------------------------------------------------
{% macro show_pagination(paginator, endpoint, kwargs={}) %}

    <ul class="pagination">
      {%- if paginator.has_prev %}
        <li><a href="{{ url_for(endpoint, page=paginator.prev_num, **kwargs) }}"
         rel="me prev">«</a></li>
      {% else %}
        <li class="disabled"><span>«</span></li>
      {%- endif %}

      {%- for page in paginator.pages %}
        {% if page %}
          {% if page != paginator.page %}
            <li><a href="{{ url_for(endpoint, page=page, **kwargs) }}"
             rel="me">{{ page }}</a></li>
          {% else %}
            <li class="current"><span>{{ page }}</span></li>
          {% endif %}
        {% else %}
          <li><span class=ellipsis>…</span></li>
        {% endif %}
      {%- endfor %}

      {%- if paginator.has_next %}
        <li><a href="{{ url_for(endpoint, page=paginator.next_num, **kwargs) }}"
         rel="me next">»</a></li>
      {% else %}
        <li class="disabled"><span>»</span></li>
      {%- endif %}
    </ul>
{% endmacro %}